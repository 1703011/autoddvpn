= Introduction =

如何debug系統autoddvpn的運作狀態？

= 注意 =

  * DD-WRT重開機之後，通常需要1-2分鍾連上PPTP VPN, 實際連上去的速度視情況而定，所以別急著重開機就馬上上網。
  * 重開機完成1-2分鍾後，您可以在電腦測試 *traceroute 8.8.8.8* 看看返回結果，通常第一個hop就是你的DD-WRT private IP, 而第二個hop就是VPN gateway IP, 如果你的第二個hop很明顯不是VPN IP, 那表示autoddvpn正在修改您的路由表，請再稍後30-60sec即可。
  * 如果等了很久，traceroute指令的第二hop還是你的public gateway, 那可能你的PPTP一直連不上去，你可以查看一下log, 方法如下。


= 如何查看log =
您需要ssh進入DD-WRT， 並且查看/tmp/autoddvpn.log， pptp+wget為例子內容如下：

{{{
[INFO#445] 01/Jan/1970:00:00:26 log starts
[INFO#445] 01/Jan/1970:00:00:26 getting vpnup.sh <--網路取得vpnup.sh
[INFO#445] 01/Jan/1970:00:00:41 getting vpndown.sh <--網路取得vpndown.sh
[INFO#445] 01/Jan/1970:00:00:41 modifying /tmp/pptpd_client/ip-up
[INFO#445] 01/Jan/1970:00:00:42 /tmp/pptpd_client/ip-up not exists, sleep 10sec.
[INFO#445] 01/Jan/1970:00:00:52 /tmp/pptpd_client/ip-up modified
[INFO#445] 01/Jan/1970:00:00:52 modifying /tmp/pptpd_client/ip-down
[INFO#445] 01/Jan/1970:00:00:52 /tmp/pptpd_client/ip-down modified
[INFO#445] 01/Jan/1970:00:00:52 ALL DONE. Let's wait for VPN being connected.  <-- 前置准備動作完成，等待pptp撥號成功
[INFO#722] 06/Aug/2010:10:21:04 vpnup.sh started <-- 撥號成功了，開始進行vpnup.sh動作
[INFO#722] 06/Aug/2010:10:21:25 preparing the exceptional routes
[INFO#722] 06/Aug/2010:10:21:25 modifying the exceptional routes
[INFO#722] 06/Aug/2010:10:21:25 fetching exceptional routes for flickr
[INFO#722] 06/Aug/2010:10:21:25 adding 68.142.214.43 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 adding 69.147.90.159 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 adding 69.147.90.215 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 adding 67.195.19.66 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 adding 67.195.19.74 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 adding 68.142.214.24 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 fetching exceptional routes for dropbox
[INFO#722] 06/Aug/2010:10:21:26 adding 174.129.27.0/24 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 adding 184.73.211.0/24 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 adding 204.236.220.0/24 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 fetching exceptional routes for vimeo
[INFO#722] 06/Aug/2010:10:21:26 adding 66.235.126.128 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:26 fetching exceptional routes for nexttv
[INFO#722] 06/Aug/2010:10:21:26 adding 210.242.234.154 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:27 adding 96.17.8.110 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:27 adding 203.69.113.0/24 via wan_gateway
[INFO#722] 06/Aug/2010:10:21:27 modifying custom exceptional routes if available
[INFO] 06/Aug/2010:10:21:28 vpnup.sh ended  <--- vpnup.sh完成，到這裡應該基本OK了

}}}

或者也可以在DD-WRT的web管理界面的命令輸入框打 * cat /tmp/autoddvpn.log * 然後按下Run Command, 也會傳回LOG記錄。


然後[http://code.google.com/p/autoddvpn/issues/list 發Issues給我]， 方便我追蹤。

如果你最後搞定了，請在twitter上告訴我 @autoddvpn 。